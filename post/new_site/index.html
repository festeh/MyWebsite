<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=HandheldFriendly content="True"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer-when-downgrade"><title>Creating a personal website from scratch</title><meta name=description content><link rel=icon type=image/x-icon href=https://dimalip.in/favicon.ico><link rel=apple-touch-icon-precomposed href=https://dimalip.in/favicon.png><link rel=stylesheet href="https://dimalip.in/css/style.css?rnd=1594671415"><meta property="og:title" content="Creating a personal website from scratch"><meta property="og:description" content="How to create a website with Hugo, host it on GitHub pages and add CloudFlare support."><meta property="og:type" content="article"><meta property="og:url" content="https://dimalip.in/post/new_site/"><meta property="og:image" content="https://dimalip.in/images/og-featured.png"><meta property="article:published_time" content="2020-07-01T12:52:57+03:00"><meta property="article:modified_time" content="2020-07-01T12:52:57+03:00"><meta property="og:site_name" content="Dima Lipin's Personal Website"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://dimalip.in/images/og-featured.png"><meta name=twitter:title content="Creating a personal website from scratch"><meta name=twitter:description content="How to create a website with Hugo, host it on GitHub pages and add CloudFlare support."><script type=application/javascript>var dnt=(navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack);var doNotTrack=(dnt=="1"||dnt=="yes");if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-171403903-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css integrity=sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq crossorigin=anonymous><script>window.WebFontConfig={custom:{families:['KaTeX_AMS','KaTeX_Caligraphic:n4,n7','KaTeX_Fraktur:n4,n7','KaTeX_Main:n4,n7,i4,i7','KaTeX_Math:i4,i7','KaTeX_Script','KaTeX_SansSerif:n4,n7,i4','KaTeX_Size1','KaTeX_Size2','KaTeX_Size3','KaTeX_Size4','KaTeX_Typewriter'],},};</script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js integrity=sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js integrity=sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI crossorigin=anonymous onload=renderMathInElement(document.body);></script></head><body><a class=skip-main href=#main>Skip to main content</a><div class=container><header class=header-nav><h1 class=site-header><a href=/>Dima Lipin</a></h1><nav><a href=https://dimalip.in/privacy_policy/>Privacy</a> <a href=https://dimalip.in/about/ title=About>About</a></nav></header><main id=main tabindex=-1><article class=post><header><h1 class=post-title>Creating a personal website from scratch</h1><div class=post-info><div class=post-date>1 Jul 20</div><div class=post-taxonomies></div></div></header><div class=content><h1 id=introduction>Introduction</h1><p>One day I came up with an idea to create a technical blog to share knowledge with the world. While the most obvious idea is to use Medium, I don't like it very much because of its nagging "3 free articles per month" feature. Besides, while there are so many people writing about Machine Learning there, Medium owners cannot simply add the ability to write in LaTeX without tricks like pasting images with rendered formulas. So I decided to create a personal website.</p><p><span class=math>\(\mathcal{L}_{D}^{GAN} = \mathbb{E}_{x \sim p_{d}}[\log D(x)] - \mathbb{E}_{\hat x \sim p_{g}}[\log (1 - D(\hat x))]
\)</span> - take this, Medium!</p><p>There are plenty of options that will instantly generate your site like Wordpress, but as Fred Durst told us:<blockquote>If you want something done right - you just do it yourself.</blockquote>so I advise you to take a strong and independent way and use <a href=https://gohugo.io/>Hugo</a> static site generator. A week ago I was a complete noob and had no clue about how to generate a website and host it. I'm still a noob but at least I read some tutorials. <a href=https://www.toptal.com/github/unlimited-scale-web-hosting-github-pages-cloudflare>This</a> and <a href=https://medium.com/@asishrs/automate-your-github-pages-deployment-using-hugo-and-actions-518b959a51f9>this</a> helped me a lot and this post basically combines them into one, but additionally it contains some fixes that I had to add so everything started to work properly and has an improved deploy script.</p><h1 id=creating-site-content-with-hugo>Creating site content with Hugo</h1><p>Hugo allows you to generate plain html files that you can place on a webserver. So your site will be static and all interactions with users should be done via JavaScript. For example, if you want to add comments, you can embed <a href=https://help.disqus.com/en/articles/1717112-universal-embed-code>Disqus</a> code on your pages.
Hugo is easy to start with - just watch some tutorials (I watched <a href=https://www.mikedane.com/static-site-generators/hugo/>this</a> series), pick a <a href=https://themes.gohugo.io/>theme</a> and you're good to (hu)go! After you add some content to your site, initialize a git repository in the root folder and the sources of your site to GitHub.</p><h1 id=automatically-deploy-your-website-to-github-pages>Automatically deploy your website to GitHub Pages</h1><p>I believe that deployment should be automated as much as possible. Ideally, when you add some changes to your website and push them to remote repository (let's call it source), your website should magically update itself. And <a href=https://github.com/features/actions>GitHub Actions</a> is a secret sauce that we need. We want to construct a pipeline that works on a remote server and do these steps when a push to source repository occurs</p><ol><li>Downloads source repository</li><li>Installs hugo</li><li>Builds site with hugo</li><li>Pushes generated files to another repository (let's call it target)</li></ol><p>Then you can use GitHub Pages to host your static website from a target repository. GitHub Pages offers free hosting for static websites with some constraints (target repository size should be <span class=math>\(\le \)</span> 1GB, bandwidth is <span class=math>\(\le\)</span> 100GB/month, your repository will be publicly visible), but they are totally feasible for a personal blog.</p><h1 id=deploying-instruction>Deploying instruction</h1><p>First, create a target repository on GitHub with an arbitrary name.</p><p>Then create a SSH key pair by entering this command in terminal<div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ ssh-keygen -t rsa -b <span style=color:#ae81ff>4096</span> -C <span style=color:#e6db74>&#34;[YOUR EMAIL]&#34;</span> -f githubpages</code></pre></div>This will create <code>githubpages</code> and <code>githubpages.pub</code> files in your directory.</p><p>Now open settings of your target repository on GitHub and go into <code>Deploy keys</code>. Click <code>Add deploy key</code>, set the title to your favorite dog name (or any arbitrary string) and paste the content of
<code>githubpages</code> into <code>Key</code> field. Don't forget to tick <code>Allow write access</code>. Click <code>Add key</code>. You'll see something like this<figure><img class=lazyload data-src=/new_site/deploykey.png></figure>(your fingerprint may differ)</p><p>Then go into source repository settings, click <code>Secrets</code>, then <code>New Secret</code>, name it <code>ACTIONS_DEPLOY_KEY</code> and paste the contents of <code>githubpages.pub</code> into <code>value</code> and click <code>Add</code> - you'll see this<figure><img class=lazyload data-src=/new_site/secretkey.png></figure></p><p>Now create a file <code>.github/workflows/pages.yml</code> in the root directory of your source repository with the following content</p><p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#66d9ef>name</span>: publish hugo site

<span style=color:#66d9ef>on</span>:
  <span style=color:#66d9ef>push</span>:
    <span style=color:#66d9ef>branches</span>:
    - master

<span style=color:#66d9ef>jobs</span>:
  <span style=color:#66d9ef>build-deploy</span>:
    <span style=color:#66d9ef>runs-on</span>: ubuntu<span style=color:#ae81ff>-18.04</span>
    <span style=color:#66d9ef>steps</span>:
    - <span style=color:#66d9ef>uses</span>: actions/checkout@v2

    - <span style=color:#66d9ef>name</span>: Setup Hugo
      <span style=color:#66d9ef>uses</span>: peaceiris/actions-hugo@v2
      <span style=color:#66d9ef>with</span>:
        <span style=color:#66d9ef>hugo-version</span>: <span style=color:#e6db74>&#39;latest&#39;</span>

    - <span style=color:#66d9ef>name</span>: Build
      <span style=color:#66d9ef>run</span>: HUGO_ENV=production hugo --minify

    - <span style=color:#66d9ef>name</span>: Deploy
      <span style=color:#66d9ef>uses</span>: peaceiris/actions-gh-pages@v3
      <span style=color:#66d9ef>with</span>:
        <span style=color:#66d9ef>deploy_key</span>: ${{ secrets.ACTIONS_DEPLOY_KEY }}
        <span style=color:#66d9ef>commit_message</span>: ${{ github.event.head_commit.message }}
        <span style=color:#66d9ef>publish_dir</span>: ./public
        <span style=color:#66d9ef>publish_branch</span>: master
        <span style=color:#66d9ef>external_repository</span>: [YOUR GITHUB USERNAME]/[YOUR TARGET REPOSITORY NAME]</code></pre></div>(don't forget to insert your credentials)</p><p>Push it to GitHub and behold how your target repository will magically update! The final step here is to enable GitHub Pages hosting. Go to the settings of the target repostory, scroll down to <code>GitHub Pages</code> and select <code>master</code> branch under <code>source</code>. If you'd like to enable CloudFlare proxy (in the next section) make sure to tick off <code>Enforce HTTPS</code>, as CloudFlare would provide you another free SSL certificate and somehow it <a href=https://community.cloudflare.com/t/github-pages-require-disabling-cfs-http-proxy/147401>doesn't play nicely</a> with GitHub Pages.
After that you'll see a message "Your site is ready to be published at [LINK]". Click it and enjoy!</p><h1 id=custom-domain-and-cdnssl-support-with-cloudflare>Custom domain and CDN+SSL support with CloudFlare</h1><p>The site kinda works and magically updates, but the domain</p><blockquote><p><code>[YOUR GITHUB USERNAME].github.io/[YOUR TARGET REPOSITORY NAME]</code></p></blockquote><p>defines you as a person worse than a custom domain name like
<span style=color:green>https://iam.irish</span>.
Also the bandwidth constraint can become a problem, so it would be great to use a CDN provider that will cache most requests to your website and also make it more available to the world. And thankfully CloudFlare gives us that chance. In this section I'll tell about adding a fancy domain name and using CloudFlare proxy.</p><p>Nowadays there are a lot of domain registrars that enable you to rent a domain name for a few years. Choose one that will have the most nice price - this is the only thing for which you'll probably need to pay, but a cool name should worth it! After you rented a domain named [YOUR DOMAIN NAME] make the following change to <code>Deploy</code> step in <code>pages.yml</code> file.<div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml> <span style=color:#66d9ef>with</span>:
   <span style=color:#66d9ef>cname</span>: [YOUR DOMAIN NAME]
   <span style=color:#66d9ef>deploy_key</span>: ${{ secrets.ACTIONS_DEPLOY_KEY }}
   <span style=color:#66d9ef>commit_message</span>: ${{ github.event.head_commit.message }}
   <span style=color:#66d9ef>publish_dir</span>: ./public
   <span style=color:#66d9ef>publish_branch</span>: master
   <span style=color:#66d9ef>external_repository</span>: [YOUR GITHUB USERNAME]/[YOUR TARGET REPOSITORY NAME]</code></pre></div></p><p>After that, register on CloudFlare, click <code>Add Site</code>, enter [YOUR DOMAIN NAME] - CloudFlare will setup DNS records for you<figure><img class=lazyload data-src=/new_site/cflare.png></figure></p><p>Then set SSL mode to "Full (strict)" for better security.
The last step is to add CloudFlare nameservers in the dashboard of your domain registrar - for Hostinger provider the form looks like this<figure><img class=lazyload data-src=/new_site/hostinger.png></figure></p><p>After some time your, site should become available at [YOUR DOMAIN NAME]. Hooray!</p><p>If you got any issues on any step, feel free to ask me - we'll search for a solution with Google together.</p></div><script src=https://utteranc.es/client.js repo=festeh/MyWebsite issue-term=pathname theme=preferred-color-scheme crossorigin=anonymous async></script></article></main><footer><p><a href=/>Dima Lipin</a>
© 2020<br>Powered by
<a target=_blank rel="noopener noreferrer" href=https://gohugo.io/>Hugo</a>
with <a target=_blank rel="noopener noreferrer" href=https://github.com/mitrichius/hugo-theme-anubis>Anubis</a> theme.</p><script src=/lazysizes.min.js async></script></footer></div></body></html>